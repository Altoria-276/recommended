# BiasSVD 算法理论分析

## 1. 算法概述

BiasSVD (带偏置的奇异值分解) 是一种协同过滤推荐算法，用于预测用户对物品的评分。它扩展了传统的矩阵分解方法，通过引入**全局偏置**、**用户偏置**和**物品偏置**来更好地捕捉评分数据中的系统偏差。

## 2. 数学模型

给定一个用户-物品评分矩阵 $R \in \mathbb{R}^{m \times n}$，其中 $m$ 是用户数量，$n$ 是物品数量。BiasSVD 模型将评分预测表示为：

$$
\hat{r}_{ui} = \mu + b_u + b_i + q_i^T p_u
$$

其中：

- $\hat{r}_{ui}$: 用户 $u$ 对物品 $i$ 的预测评分
- $\mu$: 全局平均评分（所有评分的均值）
- $b_u$: 用户 $u$ 的偏置项（表示用户评分习惯）
- $b_i$: 物品 $i$ 的偏置项（表示物品受欢迎程度）
- $p_u \in \mathbb{R}^k$: 用户 $u$ 的隐因子向量
- $q_i \in \mathbb{R}^k$: 物品 $i$ 的隐因子向量
- $k$: 隐因子维度（超参数）

## 3. 损失函数

目标是最小化预测评分与实际评分之间的平方误差，同时加入正则化项防止过拟合：

$$
\min_{p_u,q_i,b_u,b_i} \sum_{(u,i) \in \mathcal{K}} \left( r_{ui} - \hat{r}_{ui} \right)^2 + \lambda \left( \|p_u\|^2 + \|q_i\|^2 + b_u^2 + b_i^2 \right)
$$

其中：

- $\mathcal{K}$: 已知评分的集合
- $\lambda$: 正则化系数（超参数）
- $\| \cdot \|$: L2 范数

## 4. 优化方法

使用**随机梯度下降 (SGD)** 优化模型参数：

### 4.1 计算预测误差

$$
e_{ui} = r_{ui} - \hat{r}_{ui}
$$

### 4.2 参数更新规则

1. 用户偏置更新：

   $$
   b_u \leftarrow b_u + \gamma \left( e_{ui} - \lambda b_u \right)
   $$
2. 物品偏置更新：

   $$
   b_i \leftarrow b_i + \gamma \left( e_{ui} - \lambda b_i \right)
   $$
3. 用户隐因子更新：

   $$
   p_u \leftarrow p_u + \gamma \left( e_{ui} \cdot q_i - \lambda p_u \right)
   $$
4. 物品隐因子更新：

   $$
   q_i \leftarrow q_i + \gamma \left( e_{ui} \cdot p_u - \lambda q_i \right)
   $$

其中：

- $\gamma$: 学习率（超参数）

### 4.3 梯度裁剪

为防止梯度爆炸，对梯度进行裁剪：

$$
\text{grad} \leftarrow \text{clip}(\text{grad}, -\text{clip\_value}, \text{clip\_value})
$$

## 5. 冷启动处理

BiasSVD 采用以下策略处理未见过的新用户/物品：

- **新用户 + 已知物品**：$\hat{r}_{ui} = \mu + b_i$
- **已知用户 + 新物品**：$\hat{r}_{ui} = \mu + b_u$
- **新用户 + 新物品**：$\hat{r}_{ui} = \mu$

## 6. 数值稳定性

为确保数值稳定性：

1. 初始化隐因子向量：$\mathcal{N}(0, 0.01)$（小方差高斯分布）
2. 检查预测误差：跳过 NaN/Inf 值
3. 评分截断：$\hat{r}_{ui} = \max(\min_{rating}, \min(\max_{rating}, \hat{r}_{ui}))$

## 7. 算法复杂度

- **空间复杂度**：$O(mk + nk)$
  - 用户隐因子矩阵：$O(mk)$
  - 物品隐因子矩阵：$O(nk)$
- **时间复杂度**（每次迭代）：
  - $O(|\mathcal{K}| \cdot k)$（线性于已知评分数和隐因子维度）

## 8. 超参数分析

1. **隐因子维度 (k)**：

   - 较低值：模型简单，可能欠拟合
   - 较高值：模型复杂，可能过拟合
   - 典型范围：20-100
2. **学习率 (γ)**：

   - 控制参数更新步长
   - 过大：震荡/发散
   - 过小：收敛慢
   - 典型值：0.001-0.01
3. **正则化系数 (λ)**：

   - 防止过拟合
   - 较大值：强正则化
   - 较小值：弱正则化
   - 典型值：0.01-0.1
4. **梯度裁剪值**：

   - 防止梯度爆炸
   - 设置依据评分范围：0.5-1倍评分范围

## 9. 评价指标

使用**均方根误差 (RMSE)** 评估模型性能：

$$
\text{RMSE} = \sqrt{\frac{1}{|\mathcal{K}|} \sum_{(u,i) \in \mathcal{K}} (r_{ui} - \hat{r}_{ui})^2}
$$

## 10. 算法优缺点

### 优点：

1. 显式建模用户/物品偏置
2. 处理稀疏数据能力强
3. 可解释性较好（偏置项）
4. 计算效率较高（线性复杂度）

### 局限性：

1. 冷启动问题（新用户/物品）
2. 仅利用评分数据（忽略内容信息）
3. 线性模型表达能力有限
